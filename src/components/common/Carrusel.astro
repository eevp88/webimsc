---
import Image from '@/components/common/Image.astro';

export interface Props {
    items?: (string | ImageMetadata)[];
    image?: string | any; // TODO: find HTMLElementProps
}
const {
  items = [],
  image = await Astro.slots.render('image')
} = Astro.props;
console.log(items)
---

<section>
{
    items && (
      <div class='slider' >
        {
            items.map( (url, index) =>{
                {
                    url  && (
                        <a name={`img_${index}`}>
                            <Image
                                className="mx-auto rounded-md w-full "
                                widths={[400, 768, 1024, 2040]}
                                sizes="(max-width: 767px) 400px, (max-width: 1023px) 768px, (max-width: 2039px) 1024px, 2040px"
                                loading="eager"
                                width={1024}
                                height={576}
                                {...image}
                                />
                        </a>
                    )
                }
            })

        }
        </div>
        <div style="background: radial-gradient(ellipse 80% 80% at 50% -20%,#7877c64d,#fff0); position: absolute; top: 0; width: 100%; height: 100%; left:0; z-index: -1"></div>
        <ul class="markers">
            {
                items.map( (url, index) =>{
                    {
                        url  && (
                        <li><a href={`#img_${index}`}></a></li>
                        )
                    }
                })
            }
        </ul>

    )
}

</section>

<style>

    section {
      timeline-scope: --carousel;
    }
    
    .markers li:nth-child(1) {
      --i: 1;
    }
    
    .markers li:nth-child(2) {
      --i: 2;
    }
    
    .markers li:nth-child(3) {
      --i: 3;
    }
    
    .markers li:nth-child(4) {
      --i: 4;
    }
    
    .slider {
      scroll-timeline: --carousel x;
      display: flex;
      flex-direction: row;
      border-radius: 4px;
      width: 600px;
      aspect-ratio: 16/9;
    
      scroll-snap-type: x mandatory;
      overscroll-behavior: contain;
      scroll-behavior: smooth;
    
      overflow-x: scroll;
      overflow-y: hidden;
    
      box-shadow: 0px 0px 50px 10px rgba(255, 255, 255, .1);
    }
    
    .markers a {
      display: block;
      width: 16px;
      aspect-ratio: 1;
      background: white;
      opacity: .7;
      border-radius: 50%;
    
      animation: activate linear;
      animation-timeline: --carousel;
      animation-range: calc((var(--i) - 1) * 25%) calc(var(--i) * 25% + 1px);
    }
    
    
    
    @keyframes activate {
      0%,
      100% {
        background: #09f;
        opacity: 1;
      }
    }
    
    .slider a {
      flex: 0 0 100%;
      width: 100%;
      scroll-snap-align: center;
    }
    
    .slider img {
      object-fit: cover;
      width: 100%;
    }
    
    .markers {
      display: flex;
      flex-direction: row;
      gap: 0.25em;
      list-style: none;
      font-size: 2em;
      position: absolute;
      bottom: 5rem;
      left: 50%;
      translate: -50% 0;
    }
    </style>